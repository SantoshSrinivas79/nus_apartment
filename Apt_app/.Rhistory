geom_line(size=12)+
ggtitle("Time line")+
xlab("")+
ylab("")+
scale_y_discrete(breaks=c("1","2","3","4"),
labels= c("Predevelopment",
"Construction",
"Lease_up",
"Stable"))
ggplot(timeline[1:idx,],aes(x=Date,y=Risk_Ctgry))+geom_line()
ggplot(timeline[1:idx,],aes(x=Date,y=Risk_Ctgry))+geom_line(aes(col=Risk_Ctgry),size=12)
ggplot(timeline[1:idx,],aes(x=Date,y=Risk_Ctgry))+
geom_line(aes(col=Risk_Ctgry),size=12)+
theme(legend.position="none")
ggplot(timeline[1:idx,],aes(x=Date,y=Risk_Ctgry))+
geom_line(aes(col=Risk_Ctgry),size=15)+
theme(legend.position="none")
plot=ggplot(timeline[1:idx,],aes(x=Date,y=Risk_Ctgry))+
geom_line(aes(col=Risk_Ctgry),size=15)+
theme(legend.position="none")+
ggtitle("Timeline")+
ylab("")+
xlab("")
ggplotly(plot)
runApp()
runApp()
300,000/15
300000/15
knitr::opts_chunk$set(warning = FALSE,message=FALSE)
library(shiny)
library(shinydashboard)
library(tidyverse)
library(readxl)
library(purrr)
library(lubridate)
library(xts)
library(timetk)
library(asrsMethods)
library(knitr)
library(DT)
library(leaflet)
library(plotly)
source("apt_functions.r")
mortg_vars=loanamort(r=.04,bal0=250000,n=30,freq=12,apr=TRUE)
head(mortg_vars)
str(mortg_vars)
exp(0)
market_rent=(20000/12)*exp(cumsum(c(0,rep(log(1+(.04/12))),239)))
market_rent=xts(market_rent,start_date+months(0:239))
start_date=as.Date("2020-08-01")
market_rent=xts(market_rent,start_date+months(0:239))
length(market_rent)
market_rent=(20000/12)*exp(cumsum(c(0,rep(log(1+(.04/12)),239))))
market_rent=xts(market_rent,start_date+months(0:239))
annual_rent=market_rent[6+(12*(0:10))]
monthly_rent=rep(annual_rent/12,rep(12,length(annual_rent)))
monthly_rent=xts(monthly_rent,start_date+months(6)+
months(0:length(monthly_rent))+
days(5))  #note rent received on 5th day of month
length(monthly_rent)
length(annual_rent)
monthly_rent=rep(annual_rent/12,rep(12,length(annual_rent)))
market_rent=(20000/12)*exp(cumsum(c(0,rep(log(1+(.04/12)),239))))
market_rent=xts(market_rent,start_date+months(0:239))
annual_rent=market_rent[6+(12*(0:11))]
monthly_rent=rep(annual_rent/12,rep(12,length(annual_rent)))
monthly_rent=xts(monthly_rent,start_date+months(5)+
months(1:length(monthly_rent))+
days(5))  #note rent received on 5th day of month
utilities_renovation=xts(rep(-300,6),start_date+months(1:6))
weekly_maint=xts(rep(-50,12*52),start_date+days(7*1:(12*52)))
insurance=xts(rep(-2000,12),start_date+years(0:11))
first_tax_date=ymd(paste0(year(start_date),"-05-15")+months(6))
first_tax_date=ymd(paste0(as.character(year(start_date)),"-05-15")+months(c(0,6)))
?ymd
year(start_date)
str(year(start_date))
paste0(year(start_date),"-05-15")
first_tax_date=ymd(paste0(year(start_date),"-05-15")+months(c(0,6)))
first_tax_date=ymd(paste0(year(start_date),"-05-15"))+months(c(0,6))
first_tax_date=first_tax_date[first_tax_date>start_date]
property_tax=xts(rep(-1500,24),first_tax_date[1]+months(6*(0:23)))
# house gets depreciation tax shield with useful life of 30 years
bldg_depreciation=xts(rep(-house_purchase_price/360,360),start_date+months(0:359))
start_date=as.Date("2020-08-01")
house_purchase_price=300000
buy_house=xts(-house_purchase_price,start_date)
mortg_proceeds=xts(250000,start_date)
#loanamort is a function for loan calcs from asrsMethods
mortg_vars=loanamort(r=.03,bal0=250000,n=30,freq=12,apr=TRUE)
mort_dates=start_date+months(0:360)
mortg_bal=xts(c(250000,mortg_vars$bal),mort_dates)
mortg_int=xts(c(0,-mortg_vars$int),mort_dates)
mortg_pmt=xts(c(0,rep(-mortg_vars$pmt,360)),mort_dates)
renovation_amt=20000
renovation=xts(rep((-renovation_amt/6),6),start_date+months(1:6))
market_rent=(20000/12)*exp(cumsum(c(0,rep(log(1+(.04/12)),239))))
market_rent=xts(market_rent,start_date+months(0:239))
annual_rent=market_rent[6+(12*(0:11))]
monthly_rent=rep(annual_rent/12,rep(12,length(annual_rent)))
monthly_rent=xts(monthly_rent,start_date+months(5)+
months(1:length(monthly_rent))+
days(5))  #note rent received on 5th day of month
utilities_renovation=xts(rep(-300,6),start_date+months(1:6))
weekly_maint=xts(rep(-50,12*52),start_date+days(7*1:(12*52)))
insurance=xts(rep(-2000,12),start_date+years(0:11))
first_tax_date=ymd(paste0(year(start_date),"-05-15"))+months(c(0,6))
first_tax_date=first_tax_date[first_tax_date>start_date]
property_tax=xts(rep(-1500,24),first_tax_date[1]+months(6*(0:23)))
# house gets depreciation tax shield with useful life of 30 years
bldg_depreciation=xts(rep(-house_purchase_price/360,360),start_date+months(0:359))
# renovation get depreciation tax shield with useful life of 5 years
renov_depreciation=xts(rep(-renovation_amt/60,60),start_date+months(6)+months(1:60))
house_value=market_rent*12*15
opcfmat=cbind(rent,utilities_renovation,weekly_maint,insurance,property_tax)
opcfmat=cbind(monthly_rent,utilities_renovation,weekly_maint,insurance,property_tax)
total_opcf=rowSums(opcfmat,na.rm=TRUE)
opcfmat=cbind(opcfmat,total_opcf)
colnames(opcfmat)=c("Rent","Utilities","Landscape/pool","Insurance","Property_tax")
colnames(opcfmat)=c("Rent","Utilities","Landscape/pool","Insurance",
"Property_tax","Total_OPCF")
ep=endpoints(opcfmat,"yearly")
ep=endpoints(opcfmat,"years")
period.apply(opcfmat,ep,sum)[1:10,]
opcfmat=cbind(monthly_rent,utilities_renovation,weekly_maint,insurance,property_tax)
total_opcf=rowSums(opcfmat,na.rm=TRUE)
head(opcfmat)
head(total_opcfmat)
total_opcf
total_opcf=xts(rowSums(opcfmat,na.rm=TRUE),index(opcfmat))
head(total_opcf)
opcfmat=cbind(opcfmat,total_opcf)
colnames(opcfmat)=c("Rent","Utilities","Landscape/pool","Insurance",
"Property_tax","Total_OPCF")
ep=endpoints(opcfmat,"years")
period.apply(opcfmat,ep,sum)[1:10,]
opcfmat=cbind(monthly_rent,utilities_renovation,weekly_maint,insurance,property_tax)
total_opcf=xts(rowSums(opcfmat,na.rm=TRUE),index(opcfmat))
opcfmat=cbind(opcfmat,total_opcf)
colnames(opcfmat)=c("Rent","Utilities","Landscape/pool","Insurance",
"Property_tax","Total_OPCF")
head(opcfmat)
apply(opcfmat,2,nona)
opcfmat=apply(opcfmat,2,nona)
period.apply(opcfmat,ep,sum)[1:10,]
period.apply(opcfmat,INDEX=ep,FUN=sum)[1:10,]
opcfmat_y=apply(opcfmat,2,period.apply,INDEX=ep,FUN=sum)
?apply(array, margin, ...)
as.zoo(opcfmat)
ep
index(opcfmat)[ep]
ep=endpoints(opcfmat,"years")
opcfmat_y=apply(opcfmat,2,ag_to_yr)
ag_to_yr=function  (x) {
x=apply(x,2,nona)
period.apply(x,INDEX=ep,FUN=sum)
}
opcfmat_y=apply(opcfmat,2,ag_to_yr)
ag_to_yr=function  (x) {
period.apply(x,INDEX=ep,FUN=sum)
}
opcfmat_y=apply(opcfmat,2,ag_to_yr)
opcfmat_y
str(opcfmat_y)
cbind(Year=2020+0:13,opcfmat_y)
cbind(Year=2020+0:13,opcfmat_y[,-1])
Year=year(start_date)+0:(-1+nrow(opcfmat))
market_rent=(20000/12)*exp(cumsum(c(0,rep(log(1+(.04/12)),239))))
market_rent=xts(market_rent,start_date+months(0:239))
annual_rent=market_rent[6+(12*(0:11))]
monthly_rent=rep(annual_rent,rep(12,length(annual_rent)))
monthly_rent=xts(monthly_rent,start_date+months(5)+
months(1:length(monthly_rent))+
days(5))  #note rent received on 5th day of month
opcfmat=cbind(monthly_rent,utilities_renovation,weekly_maint,insurance,property_tax)
total_opcf=xts(rowSums(opcfmat,na.rm=TRUE),index(opcfmat))
opcfmat=cbind(opcfmat,total_opcf)
colnames(opcfmat)=c("Rent","Utilities","Landscape/pool","Insurance",
"Property_tax","Total_OPCF")
ep=endpoints(opcfmat,"years")
opcfmat=apply(opcfmat,2,nona)
ag_to_yr=function  (x) {
period.apply(x,INDEX=ep,FUN=sum)
}
opcfmat_y=apply(opcfmat,2,ag_to_yr)
rownames(opcfmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(opcfmat))
opcfmat_y=c(Year,opcfmat_y)
round(opcfmat_y[1:10,])
opcfmat_y=apply(opcfmat,2,ag_to_yr)
rownames(opcfmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(opcfmat))
opcfmat_y=c(Year,opcfmat_y)
dim(opcfmat_y)
opcfmat_y=apply(opcfmat,2,ag_to_yr)
rownames(opcfmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(opcfmat))
opcfmat_y=cbind(Year,opcfmat_y)
round(opcfmat_y[1:10,])
ag_to_yr=function  (x) {
period.apply(x,INDEX=ep,FUN=sum)
}
ag_to_yrbs=function(x) {
period.apply(x,INDEX=ep,FUN=lastinvec)
}
show_annual(xtsmat,nyear=10,isbs=FALSE,) {
show_annual(xtsmat,nyear=10,isbs=FALSE) {
show_annual=function(xtsmat,nyear=10,isbs=FALSE) {
xtsmat=apply(xtsmat,2,nona)
ep=endpoints(xtsmat,"years")
if (isbs) {
xtsmat_y=apply(xtsmat,2,ag_to_yrbs)
} else {
xtsmat_y=apply(xtsmat,2,ag_to_yr)}
rownames(xtsmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(xtsmat_y))
xtsmat_y=cbind(Year,xtsfmat_y)
round(opcfmat_y[1:10,])
}
cfmat=cbind(opcf,buy_house,mortg_proceeds,mortg_pmt,renovation)
total_cfmat=rowSums(cfmat,na.rm=TRUE)
cfmat=cbind(cfmat,total_cfmat)
colnames(cfmat)=c("Operating_CF","House_purchase","Mort_proceeds","Moart_pmt",
"Renovation","Total")
show_annual(cfmat)
head(cfmat)
xtsmat=cfmat
nyear=10
isbs=FALSE
xtsmat=apply(xtsmat,2,nona)
ep=endpoints(xtsmat,"years")
if (isbs) {
xtsmat_y=apply(xtsmat,2,ag_to_yrbs)
} else {
xtsmat_y=apply(xtsmat,2,ag_to_yr)}
rownames(xtsmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(xtsmat_y))
xtsmat_y=cbind(Year,xtsfmat_y)
xtsmat_y=cbind(Year,xtsmat_y)
round(opcfmat_y[1:nyear,])
cfmat=cbind(total_opcf,buy_house,mortg_proceeds,mortg_pmt,renovation)
total_cfmat=rowSums(cfmat,na.rm=TRUE)
cfmat=cbind(cfmat,total_cfmat)
colnames(cfmat)=c("Operating_CF","House_purchase","Mort_proceeds","Moart_pmt",
"Renovation","Total")
show_annual(cfmat)
show_annual=function(xtsmat,nyear=10,isbs=FALSE) {
xtsmat=apply(xtsmat,2,nona)
ep=endpoints(xtsmat,"years")
if (isbs) {
xtsmat_y=apply(xtsmat,2,ag_to_yrbs)
} else {
xtsmat_y=apply(xtsmat,2,ag_to_yr)}
rownames(xtsmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(xtsmat_y))
xtsmat_y=cbind(Year,xtsmat_y)
round(opcfmat_y[1:nyear,])
}
show_annual(cfmat)
taxmat=cbind(opcf,mortg_int,bldg_depreciation,renov_depreciation)
total_tax=rowSums(taxmat,na.rm=TRUE)
taxmat=cgind(taxmat,total_tax)
taxmat=cbind(taxmat,total_tax)
show_annual(taxmat)
taxmat=cbind(total_opcf,mortg_int,bldg_depreciation,renov_depreciation)
total_tax=rowSums(taxmat,na.rm=TRUE)
taxmat=cbind(taxmat,total_tax)
colnames(taxmat)=cbind("Operating_CF","Mort_Interest","Bldg_depr",
"Reno_depr","Txbl_Inc")
show_annual(taxmat)
show_annual=function(xtsmat,nyear=10,isbs=FALSE) {
xtsmat=apply(xtsmat,2,nona)
ep=endpoints(xtsmat,"years")
if (isbs) {
xtsmat_y=apply(xtsmat,2,ag_to_yrbs)
} else {
xtsmat_y=apply(xtsmat,2,ag_to_yr)}
rownames(xtsmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(xtsmat_y))
xtsmat_y=cbind(Year,xtsmat_y)
round(xtsmat_y[1:nyear,])
}
taxmat=cbind(total_opcf,mortg_int,bldg_depreciation,renov_depreciation)
total_tax=rowSums(taxmat,na.rm=TRUE)
taxmat=cbind(taxmat,total_tax)
colnames(taxmat)=cbind("Operating_CF","Mort_Interest","Bldg_depr",
"Reno_depr","Txbl_Inc")
show_annual(taxmat)
show_annual(cfmat)
bsmat=cbind(house_value,loan_balance,house_value-loan_bal)
bsmat=cbind(house_value,loan_balance,house_value-mortg_bal)
head(house_value)
tail(house_value)
tail(mortg_bal)
owner_eq=cbind(house_value,-mortg_bal)
owner_eq=rowSums(owner_eq,na.rm=TRUE)
bsmat=cbind(house_value,loan_balance,)
owner_eq=cbind(house_value,-mortg_bal)
owner_eq=rowSums(owner_eq,na.rm=TRUE)
bsmat=cbind(house_value,mortg_bal,owner_eq)
colnames(bsmat)=c("House_Value","Loan_Balance","Owner_Equity")
show_annual(bsmat)
head(bsmat)
tail(bsmat)
market_rent=(20000/12)*exp(cumsum(c(0,rep(log(1+(.04/12)),360))))
market_rent=xts(market_rent,start_date+months(0:360))
annual_rent=market_rent[6+(12*(0:11))]
monthly_rent=rep(annual_rent,rep(12,length(annual_rent)))
monthly_rent=xts(monthly_rent,start_date+months(5)+
months(1:length(monthly_rent))+
days(5))  #note rent received on 5th day of month
house_value=market_rent*12*15
owner_eq=cbind(house_value,-mortg_bal)
owner_eq=rowSums(owner_eq,na.rm=TRUE)
bsmat=cbind(house_value,mortg_bal,owner_eq)
colnames(bsmat)=c("House_Value","Loan_Balance","Owner_Equity")
show_annual(bsmat)
head(bsmat)
tail(bsmat)
xtsmat=bsmat
xtsmat=apply(xtsmat,2,nona)
ep=endpoints(xtsmat,"years")
if (isbs) {
xtsmat_y=apply(xtsmat,2,ag_to_yrbs)
} else {
xtsmat_y=apply(xtsmat,2,ag_to_yr)}
xtsmat_y
xtsmat=bsmat
isbs=TRUE
xtsmat=apply(xtsmat,2,nona)
ep=endpoints(xtsmat,"years")
if (isbs) {
xtsmat_y=apply(xtsmat,2,ag_to_yrbs)
} else {
xtsmat_y=apply(xtsmat,2,ag_to_yr)}
xtsmat_y
rownames(xtsmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(xtsmat_y))
xtsmat_y=cbind(Year,xtsmat_y)
round(xtsmat_y[1:nyear,])
owner_eq=cbind(house_value,-mortg_bal)
owner_eq=rowSums(owner_eq,na.rm=TRUE)
bsmat=cbind(house_value,mortg_bal,owner_eq)
colnames(bsmat)=c("House_Value","Loan_Balance","Owner_Equity")
show_annual(bsmat,isbs=TRUE)
end_date=start_date+years(5)
irrcf=total_cfmat[index(total_cfmat)<=end_date]
irrval=owner_eq[end_date]
irrcfmat=cbind(irrcf,irrval)
irrcf_w_val=rowSums(irrcfmat)
irr.z(irrcf_w_val)
irrcf
end_date=start_date+years(5)
irrcf=total_cfmat[index(total_cfmat)<=end_date]
head(irrcf)
head(total_cfmat)
cfmat=cbind(total_opcf,buy_house,mortg_proceeds,mortg_pmt,renovation)
total_cfmat=rowSums(cfmat,na.rm=TRUE)
head(total_cfmat)
cfmat[,"Total"]
colnames(cfmat)
cfmat=cbind(total_opcf,buy_house,mortg_proceeds,mortg_pmt,renovation)
total_cfmat=rowSums(cfmat,na.rm=TRUE)
cfmat=cbind(cfmat,total_cfmat)
colnames(cfmat)=c("Operating_CF","House_purchase","Mort_proceeds","Moart_pmt",
"Renovation","Total")
show_annual(cfmat)
head(cfmat[,"Total"])
irrcf=totalcf[index(totalcf)<=end_date]
end_date=start_date+years(5)
end_date
totalcf=cfmat[,"Total"]
irrcf=totalcf[index(totalcf)<=end_date]
irrval=owner_eq[end_date]
irrcfmat=cbind(irrcf,irrval)
irrcf_w_val=xts(rowSums(irrcfmat),index(irrcfmat))
irr.z(irrcf_w_val)
irrcf_w_val
end_date=start_date+years(5)
totalcf=cfmat[,"Total"]
irrcf=totalcf[index(totalcf)<=end_date]
irrval=owner_eq[end_date]
irrcfmat=cbind(irrcf,irrval)
irrcf_w_val=xts(rowSums(irrcfmat,na.rm=TRUE),index(irrcfmat))
irr.z(irrcf_w_val)
head(irrcfmat)
tail(irrcfmat)
owner_eq[end_date]
oner_eq
owner_eq
irrval=bsmat[,"Owner_Equity"][end_date]
irrval
irrcfmat=cbind(irrcf,irrval)
irrcf_w_val=xts(rowSums(irrcfmat,na.rm=TRUE),index(irrcfmat))
irr.z(irrcf_w_val)
owner_eq=cbind(house_value,-mortg_bal)
owner_eq=rowSums(owner_eq,na.rm=TRUE)
bsmat=cbind(house_value,mortg_bal,owner_eq)
colnames(bsmat)=c("House_Value","Loan_Balance","Owner_Equity")
show_annual(bsmat,isbs=TRUE)
start_date=as.Date("2020-08-01")
house_purchase_price=300000
buy_house=xts(-house_purchase_price,start_date)
mortg_proceeds=xts(250000,start_date)
#loanamort is a function for loan calcs from asrsMethods
mortg_vars=loanamort(r=.03,bal0=250000,n=30,freq=12,apr=TRUE)
mort_dates=start_date+months(0:360)
mortg_bal=xts(c(250000,mortg_vars$bal),mort_dates)
mortg_int=xts(c(0,-mortg_vars$int),mort_dates)
mortg_pmt=xts(c(0,rep(-mortg_vars$pmt,360)),mort_dates)
renovation_amt=20000
renovation=xts(rep((-renovation_amt/6),6),start_date+months(1:6))
market_rent=(20000/12)*exp(cumsum(c(0,rep(log(1+(.04/12)),360))))
market_rent=xts(market_rent,start_date+months(0:360))
annual_rent=market_rent[6+(12*(0:11))]
monthly_rent=rep(annual_rent,rep(12,length(annual_rent)))
monthly_rent=xts(monthly_rent,start_date+months(5)+
months(1:length(monthly_rent))+
days(5))  #note rent received on 5th day of month
utilities_renovation=xts(rep(-300,6),start_date+months(1:6))
weekly_maint=xts(rep(-50,12*52),start_date+days(7*1:(12*52)))
insurance=xts(rep(-2000,12),start_date+years(0:11))
first_tax_date=ymd(paste0(year(start_date),"-05-15"))+months(c(0,6))
first_tax_date=first_tax_date[first_tax_date>start_date]
property_tax=xts(rep(-1500,24),first_tax_date[1]+months(6*(0:23)))
# house gets depreciation tax shield with useful life of 30 years
bldg_depreciation=xts(rep(-house_purchase_price/360,360),start_date+months(0:359))
# renovation get depreciation tax shield with useful life of 5 years
renov_depreciation=xts(rep(-renovation_amt/60,60),start_date+months(6)+months(1:60))
house_value=market_rent*12*15
opcfmat=cbind(monthly_rent,utilities_renovation,weekly_maint,insurance,property_tax)
total_opcf=xts(rowSums(opcfmat,na.rm=TRUE),index(opcfmat))
opcfmat=cbind(opcfmat,total_opcf)
colnames(opcfmat)=c("Rent","Utilities","Landscape/pool","Insurance",
"Property_tax","Total_OPCF")
ep=endpoints(opcfmat,"years")
opcfmat=apply(opcfmat,2,nona)
ag_to_yr=function  (x) {
period.apply(x,INDEX=ep,FUN=sum)
}
opcfmat_y=apply(opcfmat,2,ag_to_yr)
rownames(opcfmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(opcfmat))
opcfmat_y=cbind(Year,opcfmat_y)
round(opcfmat_y[1:10,])
ag_to_yr=function  (x) {
period.apply(x,INDEX=ep,FUN=sum)
}
ag_to_yrbs=function(x) {
period.apply(x,INDEX=ep,FUN=lastinvec)
}
show_annual=function(xtsmat,nyear=10,isbs=FALSE) {
xtsmat=apply(xtsmat,2,nona)
ep=endpoints(xtsmat,"years")
if (isbs) {
xtsmat_y=apply(xtsmat,2,ag_to_yrbs)
} else {
xtsmat_y=apply(xtsmat,2,ag_to_yr)}
rownames(xtsmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(xtsmat_y))
xtsmat_y=cbind(Year,xtsmat_y)
round(xtsmat_y[1:nyear,])
}
cfmat=cbind(total_opcf,buy_house,mortg_proceeds,mortg_pmt,renovation)
total_cfmat=rowSums(cfmat,na.rm=TRUE)
cfmat=cbind(cfmat,total_cfmat)
colnames(cfmat)=c("Operating_CF","House_purchase","Mort_proceeds","Moart_pmt",
"Renovation","Total")
show_annual(cfmat)
taxmat=cbind(total_opcf,mortg_int,bldg_depreciation,renov_depreciation)
total_tax=rowSums(taxmat,na.rm=TRUE)
taxmat=cbind(taxmat,total_tax)
colnames(taxmat)=cbind("Operating_CF","Mort_Interest","Bldg_depr",
"Reno_depr","Txbl_Inc")
show_annual(taxmat)
owner_eq=cbind(house_value,-mortg_bal)
owner_eq=rowSums(owner_eq,na.rm=TRUE)
owner_eq=cbind(house_value,-mortg_bal)
owner_eq=rowSums(owner_eq,na.rm=TRUE)
bsmat=cbind(house_value,mortg_bal,owner_eq)
colnames(bsmat)=c("House_Value","Loan_Balance","Owner_Equity")
show_annual(bsmat,isbs=TRUE)
owner_eq=cbind(house_value,-mortg_bal)
owner_eq=rowSums(owner_eq,na.rm=TRUE)
bsmat=cbind(house_value,mortg_bal,owner_eq)
colnames(bsmat)=c("House_Value","Loan_Balance","Owner_Equity")
show_annual(bsmat,isbs=TRUE)
xtsmat=bsmat
isbs=TRUE
nyear
xtsmat=apply(xtsmat,2,nona)
ep=endpoints(xtsmat,"years")
if (isbs) {
xtsmat_y=apply(xtsmat,2,ag_to_yrbs)
} else {
xtsmat_y=apply(xtsmat,2,ag_to_yr)}
rownames(xtsmat_y)=NULL
Year=year(start_date)+0:(-1+nrow(xtsmat_y))
xtsmat_y=cbind(Year,xtsmat_y)
round(xtsmat_y[1:nyear,])
owner_eq=cbind(house_value,-mortg_bal)
owner_eq=rowSums(owner_eq,na.rm=TRUE)
bsmat=cbind(house_value,mortg_bal,owner_eq)
colnames(bsmat)=c("House_Value","Loan_Balance","Owner_Equity")
show_annual(bsmat,isbs=TRUE)
end_date=start_date+years(5)
totalcf=cfmat[,"Total"]
irrcf=totalcf[index(totalcf)<=end_date]
irrval=bsmat[,"Owner_Equity"][end_date]
irrcfmat=cbind(irrcf,irrval)
irrcf_w_val=xts(rowSums(irrcfmat,na.rm=TRUE),index(irrcfmat))
irr.z(irrcf_w_val)
